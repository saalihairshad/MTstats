# retweet_sum_per_country1
retweet_data %>%
pivot_longer(-country, names_to = "income", values_to = "count")
r_count <- retweet_data$retweet_count
retweet_data$bins <- cut(r_count,3, labels= c("0-500","501-1000",">1000"))
#retweet_data$bins <- cut(r_count,5, labels= c("0-250","251-500","501-750","751-1000",">1000"))
retweet_data
# retweet_sum_per_country1 <- aggregate(bins~country, retweet_data, sum)
# retweet_sum_per_country1
r_count <- retweet_data$retweet_count
retweet_data$bins <- cut(r_count,3, labels= c("0-500","501-1000",">1000"))
#retweet_data$bins <- cut(r_count,5, labels= c("0-250","251-500","501-750","751-1000",">1000"))
retweet_data <-  retweet_data %>% distinct()
retweet_data
# retweet_sum_per_country1 <- aggregate(bins~country, retweet_data, sum)
# retweet_sum_per_country1
r_count <- retweet_data$retweet_count
retweet_data$bins <- cut(r_count,3, labels= c("0-500","501-1000",">1000"))
#retweet_data$bins <- cut(r_count,5, labels= c("0-250","251-500","501-750","751-1000",">1000"))
retweet_data <-  retweet_data %>% distinct()
retweet_data
retweet_sum_per_country1 <- aggregate(bins~country, retweet_data, sum)
r_count <- retweet_data$retweet_count
retweet_data$bins <- cut(r_count,3, labels= c("0-500","501-1000",">1000"))
#retweet_data$bins <- cut(r_count,5, labels= c("0-250","251-500","501-750","751-1000",">1000"))
retweet_data <-  retweet_data %>% distinct()
retweet_data
# retweet_sum_per_country1 <- aggregate(bins~country, retweet_data, sum)
# retweet_sum_per_country1
r_count <- retweet_data$retweet_count
retweet_data$bins <- cut(r_count,3, labels= c("0-500","501-1000",">1000"))
#retweet_data$bins <- cut(r_count,5, labels= c("0-250","251-500","501-750","751-1000",">1000"))
#retweet_data <-  retweet_data %>% distinct()
#retweet_data
# retweet_sum_per_country1 <- aggregate(bins~country, retweet_data, sum)
# retweet_sum_per_country1
r_count <- retweet_data$retweet_count
retweet_data$bins <- cut(r_count,3, labels= c("0-500","501-1000",">1000"))
retweet_data
#retweet_data$bins <- cut(r_count,5, labels= c("0-250","251-500","501-750","751-1000",">1000"))
#retweet_data <-  retweet_data %>% distinct()
#retweet_data
# retweet_sum_per_country1 <- aggregate(bins~country, retweet_data, sum)
# retweet_sum_per_country1
df <- data %>% group_by(country, bins) %>%
add_count(date)
df <- retweet_data %>% group_by(country, bins) %>%
add_count(retweet_count)
df <- retweet_data %>% group_by(country, bins) %>%
add_count(retweet_count)
df
df <- retweet_data %>% group_by(country, bins) %>%
aggregate(retweet_count)
aggregate(retweet_data, by=list(retweet_data$country, retweet_data$bins), FUN=retweet_count);
aggregate(retweet_data, by=list(retweet_data$country, retweet_data$bins), FUN=retweet_data$retweet_count);
aggregate(retweet_data, by=list(retweet_data$country, retweet_data$bins), FUN=length);
df <- retweet_data %>% group_by(country, bins) %>%
aggregate(length)
df <- retweet_data %>% group_by(country, bins) %>%
aggregate(length)
df <- retweet_data %>% group_by(country, bins) %>%
summarize(n = n())
df <- retweet_data %>% group_by(country, bins) %>%
dplyr::summarize(n = n())
df
df <- retweet_data %>% group_by(country, bins) %>%
dplyr::summarize(n = n())
df
table(df$bins, df$country)
df <- retweet_data %>% group_by(country, bins) %>%
dplyr::summarize(n = n())
df
tb_retweet<- table(df$bins, df$country)
tb_retweet
chisq_retweet <- chisq.test(tb_retweet)
chisq_retweet
df1 <- aggregate(retweet_data, by=list(retweet_data$country, retweet_data$bins), FUN=length);
df1
tb_retweet<- table(df1$Group.1, df1$Group.2)
tb_retweet
chisq_retweet <- chisq.test(tb_retweet)
chisq_retweet
df1 <- aggregate(retweet_data, by=list(retweet_data$country, retweet_data$bins), FUN=length);
df1
tb_retweet<- table( df1$Group.2,df1$Group.1)
tb_retweet
chisq_retweet <- chisq.test(tb_retweet)
chisq_retweet
df <- retweet_data %>% group_by(country, bins) %>%
dplyr::summarize(n = n())
df
tb_retweet<- table(df$bins~df$n, df$country)
df <- retweet_data %>% group_by(country, bins) %>%
dplyr::summarize(n = n())
df
tb_retweet<- table(df$bins, df$country)
tb_retweet
chisq_retweet <- chisq.test(tb_retweet)
chisq_retweet
class(df$bins)
attributes(df)$class
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
print.data.frame(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
a_table
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
a_table
a_table[is.na(a_table)] <- 0
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = bins, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
tb_retweet<- table(a_table$bins, a_table$country)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = bins, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
tb_retweet<- table(a_table$bins, a_table$country)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = bins, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
# tb_retweet<- table(a_table$bins, a_table$country)
# tb_retweet
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = bins, value = n)
#a_table
a_table[is.na(a_table)] <- 1
a_table
# tb_retweet<- table(a_table$bins, a_table$country)
# tb_retweet
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = bins, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
# tb_retweet<- table(a_table$bins, a_table$country)
# tb_retweet
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
# tb_retweet<- table(a_table$bins, a_table$country)
# tb_retweet
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
# tb_retweet<- table(a_table$bins, a_table$country)
# tb_retweet
m <- matrix(a_table, 2)
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
# tb_retweet<- table(a_table$bins, a_table$country)
# tb_retweet
m <- matrix(a_table, 2)
m
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
# tb_retweet<- table(a_table$bins, a_table$country)
# tb_retweet
m <- matrix(a_table, 8)
m
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
# tb_retweet<- table(a_table$bins, a_table$country)
# tb_retweet
m <- matrix(a_table, 9)
m
chisq_retweet <- chisq.test(a_table)
a_table <-
retweet_data %>%
group_by(country, bins) %>%
tally() %>%
spread(key = country, value = n)
#a_table
a_table[is.na(a_table)] <- 0
a_table
# tb_retweet<- table(a_table$bins, a_table$country)
# tb_retweet
m <- matrix(a_table, 9)
m
chisq_retweet <- chisq.test(m)
remove_0s <- retweet_data
remove_0s[apply(remove_0s[,-1], 1, function(x) !all(x==0)),]
retweet_data = data.frame(final_data$country, final_data$favorite_count)
colnames(retweet_data)<-c('country','retweet_count')
retweet_data
remove_0s <- retweet_data
remove_0s[apply(remove_0s[,-1], 1, function(x) !all(x==0)),]
remove_0s <- retweet_data
remove_0s <- retweet_data
rmove_0s
remove_0s <- retweet_data
remove_0s
remove_0s <- retweet_data
remove_0s
remove_0s[rowSums(remove_0s[, -1] > 0) != 0, ]
remove_0s <- retweet_data
remove_0s
remove_0s <-  filter(remove_0s, undesirable == 0)
remove_0s <- retweet_data
remove_0s
remove_0s <-  dplyr::filter(remove_0s, undesirable == 0)
remove_0s <- retweet_data
remove_0s
remove_0s <-  remove_0s[-row(remove_0s)[remove_0s == 0],]
remove_0s
library(rcompanion)
# Attempt ANOVA on un-transformed data
#Create a linear model
country <- as.factor(remove_0s$country)
model <- lm(retweet_count~country, remove_0s)
aov(model)
x = residuals(model)
plotNormalHistogram(x)
qqnorm(residuals(model), ylab="Sample Quantiles for residuals")
qqline(residuals(model), col="red")
plot(fitted(model), residuals(model))
shapiro.test(residuals(model))
T_sqrt = sqrt(x)
library(rcompanion)
plotNormalHistogram(T_sqrt)
x
T_sqrt = log(x)
library(rcompanion)
plotNormalHistogram(T_sqrt)
T_sqrt = log10(x)
library(rcompanion)
plotNormalHistogram(T_sqrt)
T_sqrt = log10(x)
library(rcompanion)
plotNormalHistogram(T_sqrt +1)
T_sqrt = log10(x+1)
library(rcompanion)
plotNormalHistogram(T_sqrt +1)
T_sqrt = log10(x+1)
library(rcompanion)
plotNormalHistogram(T_sqrt)
retweet_data = data.frame(final_data$country, final_data$favorite_count)
colnames(retweet_data)<-c('country','retweet_count', content_category)
retweet_data = data.frame(final_data$country, final_data$favorite_count, final_data$content_category)
colnames(retweet_data)<-c('country','retweet_count', "content_category")
retweet_data
a <- gather(retweet_data, "country", Freq)
a
a <- gather(retweet_data, "country", retweet_count)
a
a <- gather(country, retweet_count,content_category)
a <- gather(country,content_category)
retweet_data <- as.factor(retweet_data$content_category)
a <- gather(country, retweet_count,content_category)
retweet_data <- as.factor(retweet_data$content_category)
retweet_data <- as.factor(retweet_data$content_category)
retweet_data <- as.factor(retweet_data$content_category)
retweet_data = data.frame(final_data$country, final_data$favorite_count, final_data$content_category)
colnames(retweet_data)<-c('country','retweet_count', "content_category")
retweet_data
# retweet_data <- as.factor(retweet_data$content_category)
# retweet_data
a <- spread(retweet_data, "country",retweet_count)
# retweet_data <- as.factor(retweet_data$content_category)
# retweet_data
a <- spread(retweet_data, country,retweet_count)
# retweet_data <- as.factor(retweet_data$content_category)
# retweet_data
spread(retweet_data, content_category,retweet_count)
# retweet_data <- as.factor(retweet_data$content_category)
# retweet_data
spread(final_data, content_category,retweet_count)
# retweet_data <- as.factor(retweet_data$content_category)
# retweet_data
data <-  data.frame(final_data$country, final_data$favorite_count, final_data$content_category)
colnames(data)<-c('country','retweet_count', "content_category")
data
# retweet_data <- as.factor(retweet_data$content_category)
# retweet_data
data <-  data.frame(final_data$country, final_data$favorite_count, final_data$content_category)
colnames(data)<-c('country','retweet_count', "content_category")
data
spread(data, content_category,retweet_count)
# retweet_data <- as.factor(retweet_data$content_category)
# retweet_data
data <-  data.frame(final_data$country, final_data$favorite_count, final_data$content_category)
colnames(data)<-c('country','retweet_count', "content_category")
typeof(data)
#spread(final_data, content_category,retweet_count)
# retweet_data <- as.factor(retweet_data$content_category)
# retweet_data
data <-  final_data
#spread(final_data, content_category,retweet_count)
# retweet_data <- as.factor(retweet_data$content_category)
# retweet_data
data <-  final_data
data
#spread(final_data, content_category,retweet_count)
library(mongolite)
library(tidyverse)
library(dplyr)
library(irr)
library(jsonlite)
library(ggpubr)
library(stringi)
library(qdap)
library(cld2)
library(plyr)
library(e1071)
library("xlsx")
library(PMCMRplus)
#import MongoDB collection into R
db <- mongo(
collection = "final1",
db = "analysis",
url = "mongodb://localhost:27017/",
verbose = FALSE,
options = ssl_options()
)
#count observations
db$count()
# put environment into proper dataset - makes it easy to get an overview of nested table
df <- db$find('{}')
#take a quick look into the dataset
#glimpse(df)
# Flatten table
datacomplete <- df %>% flatten()
#Remove noise
datacomplete1<-datacomplete[!(datacomplete$finalannotationcontentcategory=="Noise"),]
# select only important columns from full dataset and save into a new data frame
# my_data <- as_tibble(datacomplete)
final_data <- datacomplete1 %>% select(retweet_count, favorite_count, app_name, country_code, country, content_category = finalannotationcontentcategory, sentiment = finalannotationsentiment, gender = finalannotationgender, created_at, text = full_text, replies)
library(mongolite)
library(tidyverse)
library(dplyr)
library(irr)
library(jsonlite)
library(ggpubr)
library(stringi)
library(qdap)
library(cld2)
library(plyr)
library(e1071)
library("xlsx")
library(PMCMRplus)
#import MongoDB collection into R
db <- mongo(
collection = "final1",
db = "analysis",
url = "mongodb://localhost:27017/",
verbose = FALSE,
options = ssl_options()
)
#count observations
db$count()
# put environment into proper dataset - makes it easy to get an overview of nested table
df <- db$find('{}')
#take a quick look into the dataset
#glimpse(df)
# Flatten table
datacomplete <- df %>% flatten()
#Remove noise
datacomplete1<-datacomplete[!(datacomplete$finalannotationcontentcategory=="Noise"),]
# select only important columns from full dataset and save into a new data frame
# my_data <- as_tibble(datacomplete)
final_data <- datacomplete1 %>% select(retweet_count, favorite_count, app_name, country_code, country, content_category = finalannotationcontentcategory, sentiment = finalannotationsentiment, gender = finalannotationgender, created_at, text = full_text, replies)
library(mongolite)
library(tidyverse)
library(dplyr)
library(irr)
library(jsonlite)
library(ggpubr)
library(stringi)
library(qdap)
library(cld2)
library(plyr)
library(e1071)
library("xlsx")
library(PMCMRplus)
#import MongoDB collection into R
db <- mongo(
collection = "final1",
db = "analysis",
url = "mongodb://localhost:27017/",
verbose = FALSE,
options = ssl_options()
)
#count observations
db$count()
# put environment into proper dataset - makes it easy to get an overview of nested table
df <- db$find('{}')
#take a quick look into the dataset
#glimpse(df)
# Flatten table
datacomplete <- df %>% flatten()
#Remove noise
datacomplete1<-datacomplete[!(datacomplete$finalannotationcontentcategory=="Noise"),]
# select only important columns from full dataset and save into a new data frame
# my_data <- as_tibble(datacomplete)
final_data <- datacomplete1 %>% select(retweet_count, favorite_count, app_name, country_code, country, content_category = finalannotationcontentcategory, sentiment = finalannotationsentiment, gender = finalannotationgender, created_at, text = full_text, replies)
