#Create a linear model
country <- as.factor(lenDF$country)
m1 <- lm(text_length~country, lenDF)
m1
#Create a linear model
country <- as.factor(lenDF$country)
m1 <- lm(text_length~country, lenDF)
anova(m1)
#Create a linear model
country <- as.factor(lenDF$country)
m1 <- lm(text_length~country, lenDF)
anova(m1)
summary(m1)
#Create a linear model
country <- as.factor(lenDF$country)
m1 <- lm(text_length~country, lenDF)
anova(m1)
#summary(m1)
hist(m1$residuals)
#Create a linear model
country <- as.factor(lenDF$country)
m1 <- lm(text_length~country, lenDF)
anova(m1)
#summary(m1)
hist(m1$residuals)
qqnorm(m1$residuals)
#Create a linear model
country <- as.factor(lenDF$country)
m1 <- lm(text_length~country, lenDF)
anova(m1)
#summary(m1)
hist(m1$residuals)
ggqqplot(m1$residuals)
x<- nchar(clean_text, type = "chars", allowNA = FALSE, keepNA = NA)
max(x)
hist(x)
library("ggpubr")
ggdensity(x,
main = "Density plot of tooth length",
xlab = "Tooth length")
ggqqplot(x)
shapiro.test(x)
library(mongolite)
library(tidyverse)
library(dplyr)
library(irr)
library(jsonlite)
library(ggpubr)
library(stringi)
library(qdap)
library(cld2)
library(plyr)
#import MongoDB collection into R
db <- mongo(
collection = "final1",
db = "analysis",
url = "mongodb://localhost:27017/",
verbose = FALSE,
options = ssl_options()
)
#count observations
db$count()
# put environment into proper dataset - makes it easy to get an overview of nested table
df <- db$find('{}')
#take a quick look into the dataset
#glimpse(df)
# Flatten table
datacomplete <- df %>% flatten()
#Remove noise
datacomplete1<-datacomplete[!(datacomplete$finalannotationcontentcategory=="Noise"),]
# select only important columns from full dataset and save into a new data frame
# my_data <- as_tibble(datacomplete)
final_data <- datacomplete1 %>% select(app_name, country_code, country, content_category = finalannotationcontentcategory, sentiment = finalannotationsentiment, gender = finalannotationgender, created_at, text = full_text)
final_data
counts <- ddply(final_data, .(final_data$content_category, final_data$country), nrow)
names(counts) <- c("Content", "Country", "Freq")
#counts
content_count <- spread(counts, "Content", Freq)
content_count <- content_count %>%  bind_rows(summarise_all(., funs(if(is.numeric(.)) sum(.) else "Total")))
content_count$Total = apply(content_count[,-1], 1, sum)
content_count
# (54/118) *100 = 45%
#AU
Contentau <- final_data %>% filter(country_code == "AU")
relFreqcontentau <- prop.table(table(Contentau$content_category))
relFreqcontentau
#CA
Contentca <- final_data %>% filter(country_code == "CA")
relFreqcontentca <- prop.table(table(Contentca$content_category))
relFreqcontentca
#FR
Contentfr <- final_data %>% filter(country_code == "FR")
relFreqcontentfr <- prop.table(table(Contentfr$content_category))
relFreqcontentfr
#DE
Contentde <- final_data %>% filter(country_code == "DE")
relFreqcontentde <- prop.table(table(Contentde$content_category))
relFreqcontentde
#IN
Contentin <- final_data %>% filter(country_code == "IN")
relFreqcontentin <- prop.table(table(Contentin$content_category))
relFreqcontentin
#NL
Contentnl <- final_data %>% filter(country_code == "NL")
relFreqcontentnl <- prop.table(table(Contentnl$content_category))
relFreqcontentnl
#GB
Contentgb <- final_data %>% filter(country_code == "GB")
relFreqcontentgb <- prop.table(table(Contentgb$content_category))
relFreqcontentgb
#US
Contentus <- final_data %>% filter(country_code == "US")
relFreqcontentus <- prop.table(table(Contentus$content_category))
relFreqcontentus
#fre
#fre <- c(relFreqcontentau,relFreqcontentca, relFreqcontentfr, relFreqcontentde, relFreqcontentin, relFreqcontentnl, relFreqcontentgb, relFreqcontentus)
#barchart for content category
#c4 = c(#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94")
ggplot(data = final_data) + aes(x = country_code, fill = factor(content_category)) +
#scale_x_discrete(guide = guide_axis(n.dodge=2)) +
geom_bar(position = "fill") +
labs(title="Content Category Count per Country", y="Content category (%)", x = "Countries" ) +
guides(x = guide_axis(angle = 90))
#+ scale_fill_manual(values = c4)
#descriptive stat for complete
summary(final_data$sentiment)
sd(final_data$sentiment)
skewness(final_data$sentiment)
kruskal.test(sentiment ~ country, data = Tweets2)
kruskal.test(sentiment ~ country, data = Tweets2)
kruskal.test(sentiment ~ country, data = final_data)
kruskal.test(gender ~ country, data = Tweets2)
kruskal.test(sentiment ~ country, data = final_data)
kruskal.test(gender ~ country, data = Tweets2)
kruskal.test(gender ~ country, data = final_data)
kruskal.test(sentiment ~ country, data = final_data)
kruskal.test(gender ~ country, data = final_data)
kruskal.test(content ~ country, data = final_data)
kruskal.test(sentiment ~ country, data = final_data)
chisq.test(gender ~ country, data = final_data)
kruskal.test(sentiment ~ country, data = final_data)
chisq.test(gender, data = final_data)
kruskal.test(sentiment ~ country, data = final_data)
?chisq.test
kruskal.test(sentiment ~ country, data = final_data)
?chisq.test
chisq.test(gender)
?chisq.test
chisq.test(gender_count)
?chisq.test
tb <- table(final_data$gender, final_data$country)
tb
?chisq.test
tb <- table(final_data$country, final_data$gender)
tb
?chisq.test
tb <- table(final_data$country, final_data$gender)
chisq.test(tb)
library(mongolite)
library(tidyverse)
library(dplyr)
library(irr)
library(jsonlite)
library(ggpubr)
library(stringi)
library(qdap)
library(cld2)
library(plyr)
#import MongoDB collection into R
db <- mongo(
collection = "final1",
db = "analysis",
url = "mongodb://localhost:27017/",
verbose = FALSE,
options = ssl_options()
)
#count observations
db$count()
# put environment into proper dataset - makes it easy to get an overview of nested table
df <- db$find('{}')
#take a quick look into the dataset
#glimpse(df)
# Flatten table
datacomplete <- df %>% flatten()
#Remove noise
datacomplete1<-datacomplete[!(datacomplete$finalannotationcontentcategory=="Noise"),]
# select only important columns from full dataset and save into a new data frame
# my_data <- as_tibble(datacomplete)
final_data <- datacomplete1 %>% select(app_name, country_code, country, content_category = finalannotationcontentcategory, sentiment = finalannotationsentiment, gender = finalannotationgender, created_at, text = full_text)
final_data
counts <- ddply(final_data, .(final_data$content_category, final_data$country), nrow)
names(counts) <- c("Content", "Country", "Freq")
#counts
content_count <- spread(counts, "Content", Freq)
content_count <- content_count %>%  bind_rows(summarise_all(., funs(if(is.numeric(.)) sum(.) else "Total")))
content_count$Total = apply(content_count[,-1], 1, sum)
content_count
# (54/118) *100 = 45%
#AU
Contentau <- final_data %>% filter(country_code == "AU")
relFreqcontentau <- prop.table(table(Contentau$content_category))
relFreqcontentau
#CA
Contentca <- final_data %>% filter(country_code == "CA")
relFreqcontentca <- prop.table(table(Contentca$content_category))
relFreqcontentca
#FR
Contentfr <- final_data %>% filter(country_code == "FR")
relFreqcontentfr <- prop.table(table(Contentfr$content_category))
relFreqcontentfr
#DE
Contentde <- final_data %>% filter(country_code == "DE")
relFreqcontentde <- prop.table(table(Contentde$content_category))
relFreqcontentde
#IN
Contentin <- final_data %>% filter(country_code == "IN")
relFreqcontentin <- prop.table(table(Contentin$content_category))
relFreqcontentin
#NL
Contentnl <- final_data %>% filter(country_code == "NL")
relFreqcontentnl <- prop.table(table(Contentnl$content_category))
relFreqcontentnl
#GB
Contentgb <- final_data %>% filter(country_code == "GB")
relFreqcontentgb <- prop.table(table(Contentgb$content_category))
relFreqcontentgb
#US
Contentus <- final_data %>% filter(country_code == "US")
relFreqcontentus <- prop.table(table(Contentus$content_category))
relFreqcontentus
#fre
#barchart for content category
#c4 = c(#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94")
ggplot(data = final_data) + aes(x = country_code, fill = factor(content_category)) +
#scale_x_discrete(guide = guide_axis(n.dodge=2)) +
geom_bar(position = "fill") +
labs(title="Content Category Count per Country", y="Content category (%)", x = "Countries" ) +
guides(x = guide_axis(angle = 90))
#+ scale_fill_manual(values = c4)
#descriptive stat for complete
summary(final_data$sentiment)
sd(final_data$sentiment)
skewness(final_data$sentiment)
install.packages("e1071")
library(e1071)
library(e1071)
#descriptive stat for complete
summary(final_data$sentiment)
sd(final_data$sentiment)
skewness(final_data$sentiment)
kurtosis(final_data$sentiment)
final_data %>%
dplyr::group_by(country) %>%
dplyr::summarise(n = n(),
mean = mean(sentiment, na.rm = TRUE),
sd = sd(sentiment, na.rm = TRUE),
min = min(sentiment, na.rm = TRUE),
Q1 = quantile(sentiment, 0.25,na.rm = TRUE),
median= median(sentiment, na.rm = TRUE),
Q3 = quantile(sentiment, 0.75,na.rm = TRUE),
max = max(sentiment, na.rm = TRUE),
skewness = skewness(sentiment, na.rm = TRUE),
kurtosis = kurtosis(sentiment, na.rm = TRUE)
)
# Box plot colored by groups: Countrie s
ggboxplot(data=final_data, x = "country", y = "sentiment",
color = "country",
palette = c("#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94", "#5FDBDC", "#ff7043", "#8d6e63", "#9575cd")) +             labs(title="Sentiment Scores per Country", y="Sentiment", x = "Countries" ) +
guides(x = guide_axis(angle = 90))
#Results
# Sentiment is neutral and more tending to negativity when you look at the other ones
kruskal.test(sentiment ~ country, data = final_data)
senti_desc <- final_data %>%
dplyr::group_by(country) %>%
dplyr::summarise(n = n(),
mean = mean(sentiment, na.rm = TRUE),
sd = sd(sentiment, na.rm = TRUE),
min = min(sentiment, na.rm = TRUE),
Q1 = quantile(sentiment, 0.25,na.rm = TRUE),
median= median(sentiment, na.rm = TRUE),
Q3 = quantile(sentiment, 0.75,na.rm = TRUE),
max = max(sentiment, na.rm = TRUE),
skewness = skewness(sentiment, na.rm = TRUE),
kurtosis = kurtosis(sentiment, na.rm = TRUE)
)
senti_desc
setwd("~/Movies/descriptiveStatsSal/Results/1-sentiment")
senti_desc <- final_data %>%
dplyr::group_by(country) %>%
dplyr::summarise(n = n(),
mean = mean(sentiment, na.rm = TRUE),
sd = sd(sentiment, na.rm = TRUE),
min = min(sentiment, na.rm = TRUE),
Q1 = quantile(sentiment, 0.25,na.rm = TRUE),
median= median(sentiment, na.rm = TRUE),
Q3 = quantile(sentiment, 0.75,na.rm = TRUE),
max = max(sentiment, na.rm = TRUE),
skewness = skewness(sentiment, na.rm = TRUE),
kurtosis = kurtosis(sentiment, na.rm = TRUE)
)
write.csv(senti_desc)
install.packages("xlsx")
senti_desc <- final_data %>%
dplyr::group_by(country) %>%
dplyr::summarise(n = n(),
mean = mean(sentiment, na.rm = TRUE),
sd = sd(sentiment, na.rm = TRUE),
min = min(sentiment, na.rm = TRUE),
Q1 = quantile(sentiment, 0.25,na.rm = TRUE),
median= median(sentiment, na.rm = TRUE),
Q3 = quantile(sentiment, 0.75,na.rm = TRUE),
max = max(sentiment, na.rm = TRUE),
skewness = skewness(sentiment, na.rm = TRUE),
kurtosis = kurtosis(sentiment, na.rm = TRUE)
)
senti_desc
library("xlsx")
write.xlsx2(senti_desc, 'sentiment.xlsx', sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
overall_sentiment <-  final_data %>%
dplyr::summarise(n = n(),
mean = mean(sentiment, na.rm = TRUE),
sd = sd(sentiment, na.rm = TRUE),
min = min(sentiment, na.rm = TRUE),
Q1 = quantile(sentiment, 0.25,na.rm = TRUE),
median= median(sentiment, na.rm = TRUE),
Q3 = quantile(sentiment, 0.75,na.rm = TRUE),
max = max(sentiment, na.rm = TRUE),
skewness = skewness(sentiment, na.rm = TRUE),
kurtosis = kurtosis(sentiment, na.rm = TRUE)
)
overall_sentiment
overall_sentiment <-  final_data %>%
dplyr::summarise(n = n(),
mean = mean(sentiment, na.rm = TRUE),
sd = sd(sentiment, na.rm = TRUE),
min = min(sentiment, na.rm = TRUE),
Q1 = quantile(sentiment, 0.25,na.rm = TRUE),
median= median(sentiment, na.rm = TRUE),
Q3 = quantile(sentiment, 0.75,na.rm = TRUE),
max = max(sentiment, na.rm = TRUE),
skewness = skewness(sentiment, na.rm = TRUE),
kurtosis = kurtosis(sentiment, na.rm = TRUE)
)
overall_sentiment
# Box plot colored by groups: Countrie s
ggboxplot(data=final_data, x = "country", y = "sentiment",
color = "country",
palette = c("#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94", "#5FDBDC", "#ff7043", "#8d6e63", "#9575cd")) +
labs(title="", y="Sentiment", x = "Countries" ) +
guides(x = guide_axis(angle = 90))
#Results
# Sentiment is neutral and more tending to negativity when you look at the other ones
# Box plot colored by groups: Countrie s
ggboxplot(data=final_data, x = "country", y = "sentiment",
color = "country",
palette = c("#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94", "#5FDBDC", "#ff7043", "#8d6e63", "#9575cd")) +
labs(title="                  ", y="Sentiment", x = "Countries" ) +
guides(x = guide_axis(angle = 90))
#Results
# Sentiment is neutral and more tending to negativity when you look at the other ones
summary(sentiment ~ country)
summary(country)
summary(final_data$country)
summary(final_data$country)
summary(final_data$sentiment)
summary(final_data$country)
summary(final_data$country)
kruskal.test(final_data$sentiment ~ final_data$country)
summary(final_data$country)
kruskal.test(sentiment ~ country, data = final_data)
pairwise.wilcox.test(sentiment ~ country, data = final_data, p.adj="bonferroni")
pairwise.wilcox.test(sentiment, country, data = final_data, p.adj="bonferroni")
pairwise.wilcox.test(final_data$sentiment, final_data$country, p.adj="bonferroni")
?posthoc.kruskal.nemenyi.test()
library(PMCMR)
install.packages("PMCMRplus")
library(PMCMRplus)
library(PMCMRplus)
library(PMCMRplus)
?posthoc.kruskal.nemenyi.test(,)
library(PMCMRplus)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, data=final_data, dist="Tukey")
library(PMCMRplus)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, dist="Tukey")
library(PMCMRplus)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, final_data, dist="Tukey")
library(PMCMRplus)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, final_data, dist="Tukey")
library(PMCMRplus)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, final_data, dist="Tukey")
library(PMCMRplus)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, data = final_data, dist = "Tukey")
library(PMCMRplus)
posthoc.kruskal.nemenyi.test(final_data$sentiment, as.factor(final_data$country), data = final_data, dist = "Tukey")
library(PMCMRplus)
final_data$country <- as.factor(final_data$country)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, data = final_data, dist = "Tukey")
library(PMCMRplus)
final_data$country <- as.factor(final_data$country)
posthoc.kruskal.nemenyi.test(sentiment ~ country, data = final_data, dist = "Tukey")
library(PMCMRplus)
final_data$country <- as.factor(final_data$country)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, data = final_data, dist = "Tukey")
library(PMCMRplus)
final_data$country <- as.factor(final_data$country)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, data = final_data, dist = "Tukey")
posthoc.kruskal.dunn.test(final_data$sentiment, final_data$country, p.adjust.method="none")
posthoc.kruskal.dunn.test(final_data$sentiment, final_data$country, p.adjust.method="bonferroni")
posthoc.kruskal.dunn.test(final_data$sentiment, final_data$country, p.adjust.method="none")
library(mongolite)
library(tidyverse)
library(dplyr)
library(irr)
library(jsonlite)
library(ggpubr)
library(stringi)
library(qdap)
library(cld2)
library(plyr)
library(e1071)
library("xlsx")
library(PMCMRplus)
#import MongoDB collection into R
db <- mongo(
collection = "final1",
db = "analysis",
url = "mongodb://localhost:27017/",
verbose = FALSE,
options = ssl_options()
)
#count observations
db$count()
#import MongoDB collection into R
db <- mongo(
collection = "final1",
db = "analysis",
url = "mongodb://localhost:27017/",
verbose = FALSE,
options = ssl_options()
)
#count observations
db$count()
# put environment into proper dataset - makes it easy to get an overview of nested table
df <- db$find('{}')
#take a quick look into the dataset
#glimpse(df)
# Flatten table
datacomplete <- df %>% flatten()
#Remove noise
datacomplete1<-datacomplete[!(datacomplete$finalannotationcontentcategory=="Noise"),]
# select only important columns from full dataset and save into a new data frame
# my_data <- as_tibble(datacomplete)
final_data <- datacomplete1 %>% select(app_name, country_code, country, content_category = finalannotationcontentcategory, sentiment = finalannotationsentiment, gender = finalannotationgender, created_at, text = full_text)
final_data
overall_sentiment <-  final_data %>%
dplyr::summarise(n = n(),
mean = mean(sentiment, na.rm = TRUE),
sd = sd(sentiment, na.rm = TRUE),
min = min(sentiment, na.rm = TRUE),
Q1 = quantile(sentiment, 0.25,na.rm = TRUE),
median= median(sentiment, na.rm = TRUE),
Q3 = quantile(sentiment, 0.75,na.rm = TRUE),
max = max(sentiment, na.rm = TRUE),
skewness = skewness(sentiment, na.rm = TRUE),
kurtosis = kurtosis(sentiment, na.rm = TRUE)
)
overall_sentiment
senti_desc <- final_data %>%
dplyr::group_by(country) %>%
dplyr::summarise(n = n(),
mean = mean(sentiment, na.rm = TRUE),
sd = sd(sentiment, na.rm = TRUE),
min = min(sentiment, na.rm = TRUE),
Q1 = quantile(sentiment, 0.25,na.rm = TRUE),
median= median(sentiment, na.rm = TRUE),
Q3 = quantile(sentiment, 0.75,na.rm = TRUE),
max = max(sentiment, na.rm = TRUE),
skewness = skewness(sentiment, na.rm = TRUE),
kurtosis = kurtosis(sentiment, na.rm = TRUE)
)
senti_desc
#barchart for gender
ggplot(final_data) +
aes(x = country, y= sentiment, fill = country) +
geom_boxplot() +
labs(y="Sentiment", x = "Countries")+
scale_fill_manual(values = alpha(c("#FFDD8A", "#5ADB94", "#5FDBDC", "#8d6e63", "#9575cd","#ff7043","#76BFF1", "#ff6384"), .4)) +
guides(x = guide_axis(angle = 90)) +
theme_bw() +
geom_jitter(color="black", size=0.4, alpha=0.3)
library(plyr)
count(final_data, 'country')
kruskal.test(sentiment ~ country, data = final_data)
kruskal.test(sentiment ~ country, data = final_data)
library(PMCMR)
final_data$country <- as.factor(final_data$country)
posthoc.kruskal.nemenyi.test(final_data$sentiment, final_data$country, data = final_data, dist = "Tukey")
final_data$country <- as.factor(final_data$country)
posthoc.kruskal.nemenyi.test(sentiment ~ country, data = final_data, dist = "Chisquare")
posthoc.kruskal.dunn.test(final_data$sentiment, final_data$country, p.adjust.method="none")
posthoc.kruskal.dunn.test(final_data$sentiment, final_data$country, p.adjust.method="bonferroni")
install.packages("dunn.test")
install.packages("FSA")
#options(scipen=9999)
#options(dplyr.print_max = 1e9)
#options(tibble.print_max = Inf)
library("dunn.test")
library("FSA")
dunn_df <- dunnTest(final_data$sentiment, final_data$country, method="bonferroni")
dunn_df
#View(dunn_df)
