ggplot(data = final_data) +
aes(x = country, fill = content_category) +
#scale_x_discrete(guide = guide_axis(n.dodge=2)) +
geom_bar(position = "fill") +
labs(y="Content Category (%)", x = "Countries" ) +
scale_fill_manual(values = alpha(c("#ff6384", "#5ADB94", "#FFDD8A","#76BFF1"), .4))+
scale_y_continuous(labels = scales::percent_format()) +
guides(x = guide_axis(angle = 90)) +theme_bw() +
facet_grid( . ~content_category)
#barchart for content category
#c4 = c(#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94")
ggplot(data = final_data) +
aes(x = country) +
#scale_x_discrete(guide = guide_axis(n.dodge=2)) +
geom_bar(position = "fill") +
labs(y="Content Category (%)", x = "Countries" ) +
scale_fill_manual(values = alpha(c("#ff6384", "#5ADB94", "#FFDD8A","#76BFF1"), .4))+
scale_y_continuous(labels = scales::percent_format()) +
guides(x = guide_axis(angle = 90)) +theme_bw() +
facet_grid( . ~content_category)
#barchart for content category
#c4 = c(#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94")
ggplot(data = final_data) +
aes(x = country, fill = content_category) +
#scale_x_discrete(guide = guide_axis(n.dodge=2)) +
geom_bar(position = "fill") +
labs(y="Content Category (%)", x = "Countries" ) +
scale_fill_manual(values = alpha(c("#ff6384", "#5ADB94", "#FFDD8A","#76BFF1"), .4))+
scale_y_continuous(labels = scales::percent_format()) +
guides(x = guide_axis(angle = 90)) +theme_bw()
z <- final_data
z <- data.frame(final_data$country, final_data$content_category)
colnames(z)<- c("country", "content_category")
z <- z %>% group_by(country, content) %>%
add_count(country)  %>%
distinct()
z <- final_data
z <- data.frame(final_data$country, final_data$content_category)
colnames(z)<- c("country", "content_category")
z <- z %>% group_by(country, content_category) %>%
add_count(country)  %>%
distinct()
z
str(z)
str(z)
df1 <- z %>%
select(country, content_category) %>%
group_by(country, content_category) %>%
summarise(n = n())
str(z)
df1 <- z %>%
select(country, content_category) %>%
group_by(country, content_category) %>%
summarise( n())
z <- final_data
z <- data.frame(final_data$country, final_data$content_category)
colnames(z)<- c("country", "content_category")
z <- z %>% group_by(country, content_category) %>%
add_count(country)  %>%
distinct()
colnames(z)<- c("country", "content_category", "count")
z
str(z)
df1 <- z %>%
select(country, content_category) %>%
group_by(country, content_category) %>%
summarise(count = n())
#str(z)
df1 <- z %>%
select(country, content_category) %>%
group_by(country, content_category) %>%
summarise(count = n())
#str(z)
df1 <- z %>%
select(country, content_category) %>%
group_by(country, content_category) %>%
dplyr::summarise(count = n())
#str(z)
df1 <- z %>%
dplyr::select(country, content_category) %>%
dplyr::group_by(country, content_category) %>%
dplyr::summarise(count = n())
#str(z)
df1 <- z %>%
dplyr::select(country, content_category)
#str(z)
df1 <- z %>%
dplyr::select(country, content_category) %>%
dplyr::group_by(country, content_category)
#str(z)
df1 <- z %>%
dplyr::select(country, content_category) %>%
dplyr::group_by(country, content_category)
df1
#str(z)
df1 <- z %>%
dplyr::select(country, content_category) %>%
dplyr::group_by(country, content_category) %>%
dplyr::summarise(count = n())
df1
#str(z)
# df1 <- z %>%
#   dplyr::select(country, content_category) %>%
#   dplyr::group_by(country, content_category) %>%
#   dplyr::summarise(count = n())
#
# df1
#barchart for content category
#c4 = c(#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94")
ggplot(data = z, aes(x = country, y=count, fill = content_category)) +
#scale_x_discrete(guide = guide_axis(n.dodge=2)) +
geom_bar(position = "fill") +
labs(y="Content Category (%)", x = "Countries" ) +
scale_fill_manual(values = alpha(c("#ff6384", "#5ADB94", "#FFDD8A","#76BFF1"), .4))+
scale_y_continuous(labels = scales::percent_format()) +
guides(x = guide_axis(angle = 90)) +theme_bw()
#barchart for content category
#c4 = c(#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94")
ggplot(data = z, aes(x = country, y=count, fill = content_category)) +
#scale_x_discrete(guide = guide_axis(n.dodge=2)) +
# geom_bar(position = "fill") +
# labs(y="Content Category (%)", x = "Countries" ) +
#  scale_fill_manual(values = alpha(c("#ff6384", "#5ADB94", "#FFDD8A","#76BFF1"), .4))+
# scale_y_continuous(labels = scales::percent_format()) +
# guides(x = guide_axis(angle = 90)) +theme_bw()
#barchart for content category
#c4 = c(#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94")
ggplot(data = z, aes(x = country, y=count, fill = content_category))
#scale_x_discrete(guide = guide_axis(n.dodge=2)) +
# geom_bar(position = "fill") +
# labs(y="Content Category (%)", x = "Countries" ) +
#  scale_fill_manual(values = alpha(c("#ff6384", "#5ADB94", "#FFDD8A","#76BFF1"), .4))+
# scale_y_continuous(labels = scales::percent_format()) +
# guides(x = guide_axis(angle = 90)) +theme_bw()
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", aaxis.text.x = element_text(angle = -90, hjust = 0.8))
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", aaxis.text.x = element_text(angle = -90, hjust = 0.8))
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = -90, hjust = 0.8))
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country")
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
#p
df2 <- z %>%
mutate(PercentOfCount = round(count/ sum(count), digits=2))
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
#p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country")
p
df2 <- z %>%
mutate(PercentOfCount = round(count/ sum(count), digits=2))
df2
p2 <- ggplot(data = df2, aes(x = country,
y=PercentOfCount,
fill = content_category))
df2 <- z %>%
mutate(PercentOfCount = round(count/ sum(count), digits=2))
df2
p2 <- ggplot(data = df2, aes(x = country,
y=PercentOfCount,
fill = content_category))
p2
df2 <- z %>%
mutate(PercentOfCount = round(count/ sum(count), digits=2))
df2
p2 <- ggplot(data = df2, aes(x = country,
y=PercentOfCount,
fill = content_category))
p2 + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country")
p2
df2 <- z %>%
mutate(PercentOfCount = round(count/ sum(count), digits=2))
df2
p2 <- ggplot(data = df2, aes(x = country,
y=PercentOfCount,
fill = content_category))
p2 + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=PercentOfCount), position = position_fill(vjust = 0.5), size=3)
p2
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.5)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3)
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.5,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3)
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "black",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3)
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#eee",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3)
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#eeeeee",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3)
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3)
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "Dose (mg)")
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "Content Category")
p
p <- ggplot(data = z, aes(x = country,
y=count,
fill = content_category))
p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "Content Category")
p
# df2 <- z %>%
#   mutate(PercentOfCount = round(count/ sum(count), digits=2))
# df2
#
# p2 <- ggplot(data = df2, aes(x = country,
#                           y=PercentOfCount,
#                           fill = content_category))
# p2 + geom_bar(stat="identity",
#              position = "fill",
#              width = 0.6,
#              color = "black",
#              size = 0.5,
#              alpha = 0.5)+
#   theme_minimal()+
#   theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
#   labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
#   geom_text(aes(label=PercentOfCount), position = position_fill(vjust = 0.5), size=3)
# p2
tb_content <- table(final_data$country, final_data$content_category)
tb_content
chisq_content <- chisq.test(tb_content)
chisq_content
options(scipen = 9999)
xx <- pairwiseNominalIndependence(tb_content,
fisher = FALSE,
gtest  = FALSE,
chisq  = TRUE,
method = "bonferroni")
xx
typeof(xx)
#typeof(xx)
write.xlsx2(xx, 'junk.xlsx', sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
setwd("~/Movies/descriptiveStatsSal/Results/3-content")
#typeof(xx)
write.xlsx2(xx, 'junk.xlsx', sheetName = "Sheet1",
col.names = TRUE, row.names = TRUE, append = FALSE)
