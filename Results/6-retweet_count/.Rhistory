j=0
for (j in 1:(nrow(rp))) {
if(rp[j, 2] > 0) {
print('sss')
}
}
j=0
for (j in 1:(nrow(rp))) {
print('sss')
}
length(rp[['replies']][[i]])
j=0
for (j in 1:(nrow(rp))) {
print(rp[j, 2])
}
j=0
for (j in 1:(nrow(rp))) {
print(rp[j, 2][[i]])
}
j=0
for (j in 1:(nrow(rp))) {
print(rp[j, 2][i])
}
length(rp[['replies']][[i]])
j=0
for (j in 1:(nrow(rp))) {
print(rp[j, 2][j])
}
length(rp[['replies']][[i]])
j=0
for (j in 1:(nrow(rp))) {
print(rp[j, 2][j])
}
length(rp[['replies']][[i]])
do.call("rp", rp[["replies"]])
do.call("c", rp[["replies"]])
as.character((unlist(rp[["replies"]])))
as.character((unlist(length(rp[["replies"]]))))
as.character((unlist(count(rp[["replies"]]))))
require(xlsx)
z <- read.xlsx("a.xlsx", sheetName = "sheet1")
setwd("~/Movies/descriptiveStatsSal/Results/6-retweet_count")
require(xlsx)
z <- read.xlsx("a.xlsx", sheetName = "sheet1")
library(xlsx)
file <- system.file("tests", "a.xlsx", package = "xlsx")
res <- read.xlsx(file, 1)  # read first sheet
library(xlsx)
d<- read.xlsx("a.xlsx",
sheetIndex = 1)
library(readxl)
a <- read_excel("a.xlsx")
a
rp_df <- df
rp_df <- data.frame(df$country, df$favorites)
colnames(rp_df)<- c("country", "reply")
rp_df <- rp_df %>% group_by(country, reply) %>%
add_count(country)  %>%
distinct()
colnames(fv_df)<- c("country", "reply", "reply_count")
rp_df
p <- ggplot(data = rp_df, aes(x = country,
y=n,
fill = reply))
p <- p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "Content Category")
p
rp_df <- df
rp_df <- data.frame(rp$country, rp$reply)
rp_df <- rp
rp_df <- data.frame(rp$country, rp$reply)
rp <- final_data %>%
select(country, replies)
rp
library(readxl)
rp <- read_excel("a.xlsx")
rp
rp_df <- rp
rp_df <- data.frame(rp$country, rp$reply)
colnames(rp_df)<- c("country", "reply")
rp_df <- rp_df %>% group_by(country, reply) %>%
add_count(country)  %>%
distinct()
colnames(fv_df)<- c("country", "reply", "reply_count")
rp_df
p <- ggplot(data = rp_df, aes(x = country,
y=n,
fill = reply))
p <- p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "Content Category")
p
p <- ggplot(data = rp_df, aes(x = country,
y=n,
fill = reply))
p <- p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()
p
p <- ggplot(data = rp_df, aes(x = country,
y=n,
fill = reply))
p <- p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "reply")
p
p <- ggplot(data = rp_df, aes(x = country,
y=n,
fill = reply))
p <- p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))
p
p <- ggplot(data = rp_df, aes(x = country,
y=n,
fill = reply))
p <- p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=n), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "reply")
p
rp_tb <- table(rp_df$country, rp_df$reply)
rp_tb
chisq_rp <- chisq.test(rp_tb)
chisq_rp
library(mongolite)
library(tidyverse)
library(dplyr)
library(irr)
library(jsonlite)
library(ggpubr)
library(stringi)
library(qdap)
library(cld2)
library(plyr)
library(e1071)
library("xlsx")
library(PMCMRplus)
#import MongoDB collection into R
db <- mongo(
collection = "final1",
db = "analysis",
url = "mongodb://localhost:27017/",
verbose = FALSE,
options = ssl_options()
)
#count observations
db$count()
# put environment into proper dataset - makes it easy to get an overview of nested table
df <- db$find('{}')
#take a quick look into the dataset
#glimpse(df)
# Flatten table
datacomplete <- df %>% flatten()
#Remove noise
datacomplete1<-datacomplete[!(datacomplete$finalannotationcontentcategory=="Noise"),]
# select only important columns from full dataset and save into a new data frame
# my_data <- as_tibble(datacomplete)
final_data <- datacomplete1 %>% select(retweet_count, favorite_count, app_name, country_code, country, content_category = finalannotationcontentcategory, sentiment = finalannotationsentiment, gender = finalannotationgender, created_at, text = full_text, replies)
final_data$country <- as.factor(final_data$country)
final_data
#data <- source('/Movies/descriptiveStatsSal/Results/load_data.r')
rt <- final_data %>%
select(country, retweet_count, favorite_count)
rt$retweets <- rt$retweet_count
rt$favorites <- rt$favorite_count
#rt$retweets2 <- rt$retweet_count
rt
j=0
for (j in 1:(nrow(rt))) {
if(rt[j, 5] > 0) {
rt[j, 5] <- "yes"
} else
rt[j, 5] <- "no"
}
# for (j in 1:(nrow(rt))) {
#   if(rt[j, 4] > 0) {
#     rt[j, 4] <- 1
#   } else
#      rt[j, 4] <- 0
# }
for (j in 1:(nrow(rt))) {
if(rt[j, 4] > 0) {
rt[j, 4] <- "yes"
} else
rt[j, 4] <- "no"
}
rt
count(rt, vars = c("retweets"))
count(rt, vars = c("country","retweets"))
df <- rt %>%select(country, retweets, favorites)
df
mycolor <- c("#fbb4b9", "#fdcdac", "#a6cee3", "#76BFF1")
#barchart for content category
#c4 = c(#76BFF1", "#ff6384", "#FFDD8A", "#5ADB94")
ggplot(data = rt) +
aes(x = country, fill = retweets) +
scale_x_discrete(guide = guide_axis(n.dodge=2)) +
geom_bar(position = "dodge") +
labs(y="Retweet Count", x = "Countries" ) +
scale_fill_manual(values = alpha(c("#ff6384", "#5ADB94"), 0.4)) +
#  scale_y_continuous(labels = scales::percent_format()) +
guides(x = guide_axis(angle = 90)) +theme_bw()
retweets_df <- df
retweets_df <- data.frame(df$country, df$retweets)
colnames(retweets_df)<- c("country", "retweets")
retweets_df <- retweets_df %>% group_by(country, retweets) %>%
add_count(country)  %>%
distinct()
colnames(retweets_df)<- c("country", "retweets", "count")
retweets_df
p <- ggplot(data = retweets_df, aes(x = country,
y=count,
fill = retweets))
p <- p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "Content Category")
p
rt_tb <- table(df$country, df$retweets)
rt_tb
chisq_rt <- chisq.test(rt_tb)
chisq_rt
fv_df <- df
fv_df <- data.frame(df$country, df$favorites)
colnames(fv_df)<- c("country", "favorites")
fv_df <- fv_df %>% group_by(country, favorites) %>%
add_count(country)  %>%
distinct()
colnames(fv_df)<- c("country", "favorites", "count")
fv_df
p <- ggplot(data = fv_df, aes(x = country,
y=count,
fill = favorites))
p <- p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=count), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "Content Category")
p
fv_tb <- table(df$country, df$favorites)
fv_tb
chisq_fv <- chisq.test(fv_tb)
chisq_fv
rp_df <- rp
rp_df <- data.frame(rp$country, rp$reply)
colnames(rp_df)<- c("country", "reply")
rp_df <- rp_df %>% group_by(country, reply) %>%
add_count(country)  %>%
distinct()
colnames(fv_df)<- c("country", "reply", "reply_count")
rp_df
p <- ggplot(data = rp_df, aes(x = country,
y=n,
fill = reply))
p <- p + geom_bar(stat="identity",
position = "fill",
width = 0.6,
color = "#333333",
size = 0.3,
alpha = 0.4)+
theme_minimal()+
theme(legend.position = "right", axis.text.x = element_text(angle = 90, hjust = 0.8))+
labs(x="Country", y="Total Count", title = "Content Categories Count by Country") +
geom_text(aes(label=n), position = position_fill(vjust = 0.5), size=3) +
labs(fill = "reply")
p
rp_tb <- table(rp$country, rp$reply)
rp_tb
chisq_rp <- chisq.test(rp_tb)
chisq_rp
library(rcompanion)
options(scipen = 9999)
reply_posthoc <- pairwiseNominalIndependence(rp_tb,
fisher = FALSE,
gtest  = FALSE,
chisq  = TRUE,
method = "bonferroni")
reply_posthoc
#png(height=500, width=500, pointsize=15, file="overlap.png")
corrplot(chisq_rp$residuals, is.cor = FALSE, mar = c(0,0,1,0), tl.cex = 0.8, method="circle",type="full",cl.ratio = 0.6, cl.align = "r", cl.offset =  0.14, )
library(corrplot)
#png(height=500, width=500, pointsize=15, file="overlap.png")
corrplot(chisq_rp$residuals, is.cor = FALSE, mar = c(0,0,1,0), tl.cex = 0.8, method="circle",type="full",cl.ratio = 0.6, cl.align = "r", cl.offset =  0.14, )
0.04317<0.05
rp
rp
rt <- rp %>%
select(country, reply)
rt
culture_df <- rp %>%
select(country, reply)
culture_df
final_data_culture <- culture_df
final_data_culture$culturegroup <- NA
final_data_culture$PD <- NA
final_data_culture$IDVI <- NA
final_data_culture$MA <- NA
final_data_culture$UA <- NA
final_data_culture$LTO <- NA
final_data_culture$INDU <- NA
i=0
for (i in 1:(nrow(final_data_culture))) {
if (final_data_culture$country_code[i] == "AU") {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "high"
final_data_culture$LTO[i] <- "low"
final_data_culture$INDU[i] <- "high"
} else if (final_data_culture$country_code[i] == "CA" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "low"
final_data_culture$LTO[i] <- "low"
final_data_culture$INDU[i] <- "high"
} else if (final_data_culture$country_code[i]== "FR" ) {
final_data_culture$PD[i] <- "high"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "low"
final_data_culture$UA[i] <- "high"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "low"
} else if (final_data_culture$country_code[i] == "DE" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "high"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "low"
} else if (final_data_culture$country_code[i] == "IN" ) {
final_data_culture$PD[i] <- "high"
final_data_culture$IDVI[i] <- "low"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "low"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "low"
}  else if (final_data_culture$country_code[i] == "NL" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "low"
final_data_culture$UA[i] <- "high"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "high"
}  else if (final_data_culture$country_code[i] == "GB" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "low"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "high"
} else if (final_data_culture$country_code[i] == "US" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "low"
final_data_culture$LTO[i] <- "low"
final_data_culture$INDU[i] <- "high"
}
}
final_data_culture <- culture_df
final_data_culture$culturegroup <- NA
final_data_culture$PD <- NA
final_data_culture$IDVI <- NA
final_data_culture$MA <- NA
final_data_culture$UA <- NA
final_data_culture$LTO <- NA
final_data_culture$INDU <- NA
i=0
for (i in 1:(nrow(final_data_culture))) {
if (final_data_culture$country[i] == "Australia") {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "high"
final_data_culture$LTO[i] <- "low"
final_data_culture$INDU[i] <- "high"
} else if (final_data_culture$country[i] == "Canada" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "low"
final_data_culture$LTO[i] <- "low"
final_data_culture$INDU[i] <- "high"
} else if (final_data_culture$country[i]== "France" ) {
final_data_culture$PD[i] <- "high"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "low"
final_data_culture$UA[i] <- "high"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "low"
} else if (final_data_culture$country[i] == "Germany" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "high"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "low"
} else if (final_data_culture$country[i] == "India" ) {
final_data_culture$PD[i] <- "high"
final_data_culture$IDVI[i] <- "low"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "low"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "low"
}  else if (final_data_culture$country[i] == "Netherlands" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "low"
final_data_culture$UA[i] <- "high"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "high"
}  else if (final_data_culture$country[i] == "United Kingdom" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "low"
final_data_culture$LTO[i] <- "high"
final_data_culture$INDU[i] <- "high"
} else if (final_data_culture$country[i] == "United States" ) {
final_data_culture$PD[i] <- "low"
final_data_culture$IDVI[i] <- "high"
final_data_culture$MA[i] <- "high"
final_data_culture$UA[i] <- "low"
final_data_culture$LTO[i] <- "low"
final_data_culture$INDU[i] <- "high"
}
}
df_culture1 <- data.frame(final_data_culture$country, final_data_culture$PD, final_data_culture$IDVI, final_data_culture$MA, final_data_culture$UA, final_data_culture$LTO, final_data_culture$INDU)
colnames(df_culture1) <- c("country", "PD", "IDVI", "MA", "UA", "LTO", "INDU")
df_culture1
final_data_culture
tb <- table(final_data_culture$reply, final_data_culture$PD)
tb
chisq.test(tb)
library(lsr)
cramersV(tb)
tb <- table(final_data_culture$reply, final_data_culture$IDVI)
tb
chisq.test(tb)
library(lsr)
cramersV(tb)
tb <- table(final_data_culture$reply, final_data_culture$INDU)
tb
chisq.test(tb)
library(lsr)
cramersV(tb)
tb <- table(final_data_culture$reply, final_data_culture$UA)
tb
chisq.test(tb)
library(lsr)
cramersV(tb)
tb <- table(final_data_culture$reply, final_data_culture$LTO)
tb
chisq.test(tb)
library(lsr)
cramersV(tb)
